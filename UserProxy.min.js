var UserProxy = (function(){var requirejs,require,define;!function(e){function n(e,n){return m.call(e,n)}function t(e,n){var t,r,i,o,u,f,a,s,c,l,p,d=n&&n.split("/"),v=g.map,y=v&&v["*"]||{};if(e&&"."===e.charAt(0))if(n){for(d=d.slice(0,d.length-1),e=e.split("/"),u=e.length-1,g.nodeIdCompat&&b.test(e[u])&&(e[u]=e[u].replace(b,"")),e=d.concat(e),c=0;c<e.length;c+=1)if(p=e[c],"."===p)e.splice(c,1),c-=1;else if(".."===p){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||y)&&v){for(t=e.split("/"),c=t.length;c>0;c-=1){if(r=t.slice(0,c).join("/"),d)for(l=d.length;l>0;l-=1)if(i=v[d.slice(0,l).join("/")],i&&(i=i[r])){o=i,f=c;break}if(o)break;!a&&y&&y[r]&&(a=y[r],s=c)}!o&&a&&(o=a,f=s),o&&(t.splice(0,f,o),e=t.join("/"))}return e}function r(n,t){return function(){return c.apply(e,h.call(arguments,0).concat([n,t]))}}function i(e){return function(n){return t(n,e)}}function o(e){return function(n){d[e]=n}}function u(t){if(n(v,t)){var r=v[t];delete v[t],y[t]=!0,s.apply(e,r)}if(!n(d,t)&&!n(y,t))throw new Error("No "+t);return d[t]}function f(e){var n,t=e?e.indexOf("!"):-1;return t>-1&&(n=e.substring(0,t),e=e.substring(t+1,e.length)),[n,e]}function a(e){return function(){return g&&g.config&&g.config[e]||{}}}var s,c,l,p,d={},v={},g={},y={},m=Object.prototype.hasOwnProperty,h=[].slice,b=/\.js$/;l=function(e,n){var r,o=f(e),a=o[0];return e=o[1],a&&(a=t(a,n),r=u(a)),a?e=r&&r.normalize?r.normalize(e,i(n)):t(e,n):(e=t(e,n),o=f(e),a=o[0],e=o[1],a&&(r=u(a))),{f:a?a+"!"+e:e,n:e,pr:a,p:r}},p={require:function(e){return r(e)},exports:function(e){var n=d[e];return"undefined"!=typeof n?n:d[e]={}},module:function(e){return{id:e,uri:"",exports:d[e],config:a(e)}}},s=function(t,i,f,a){var s,c,g,m,h,b,E=[],w=typeof f;if(a=a||t,"undefined"===w||"function"===w){for(i=!i.length&&f.length?["require","exports","module"]:i,h=0;h<i.length;h+=1)if(m=l(i[h],a),c=m.f,"require"===c)E[h]=p.require(t);else if("exports"===c)E[h]=p.exports(t),b=!0;else if("module"===c)s=E[h]=p.module(t);else if(n(d,c)||n(v,c)||n(y,c))E[h]=u(c);else{if(!m.p)throw new Error(t+" missing "+c);m.p.load(m.n,r(a,!0),o(c),{}),E[h]=d[c]}g=f?f.apply(d[t],E):void 0,t&&(s&&s.exports!==e&&s.exports!==d[t]?d[t]=s.exports:g===e&&b||(d[t]=g))}else t&&(d[t]=f)},requirejs=require=c=function(n,t,r,i,o){if("string"==typeof n)return p[n]?p[n](t):u(l(n,t).f);if(!n.splice){if(g=n,g.deps&&c(g.deps,g.callback),!t)return;t.splice?(n=t,t=r,r=null):n=e}return t=t||function(){},"function"==typeof r&&(r=i,i=o),i?s(e,n,t,r):setTimeout(function(){s(e,n,t,r)},4),c},c.config=function(e){return c(e)},requirejs._defined=d,define=function(e,t,r){t.splice||(r=t,t=[]),n(d,e)||n(v,e)||(v[e]=[e,t,r])},define.amd={jQuery:!0}}(),define("../vendor/almond",function(){}),define("utils",[],function(){function e(e,n){var t=Array.prototype.slice.call(arguments,2);return function(){return n.apply(e,t.concat(Array.prototype.slice.call(arguments)))}}function n(e,n){if(r(e))for(var t=0;t<e.length&&n(t,e[t])!==!0;t++);else for(var i in e)if(e.hasOwnProperty(i)&&n(i,e[i])===!0)break}function t(e){var t=[];return n(e,function(e){t.push(e)}),t}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e,n){for(var t=0,r=n.length;r>t;t++)if(n[t]===e)return!0;return!1}function o(e,n){for(var t=0,r=n.length;r>t;t++)if(n[t]===e)return t;return-1}function u(e,n){return r(e,n)?o(e,n):void 0}function f(e,n){return Math.random()*(n-e)+e}function a(e,n){return Math.floor(Math.random()*(n-e))+e}function s(e,n){"string"!=typeof e&&(e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_"),"number"!=typeof n&&(n=64);for(var t=e.length,r="",i=0;n>i;i++)r+=e[a(0,t)];return r}function c(e,n){for(e=e.replace(/[^0-9a-zA-Z_\$]/g,"");/$[0-9]/g.test(e);){if(""===e)return n;e=e.substring(1)}return e}return{bind:e,each:n,getKeys:t,isArray:r,inArray:i,indexOf:u,indexOfArray:o,getRandomArbitrary:f,getRandomInt:a,generateToken:s,escapeECMAVariable:c}}),define("support",[],function(){function e(){try{var e=document.createEvent("CustomEvent");return e&&"function"==typeof e.initCustomEvent?(e.initCustomEvent(n,!0,!0,{mod:n}),!0):!1}catch(e){return!1}}var n="support.test";return{CustomEvent:e}}),define("CustomEvent",["utils"],function(e){function n(n,r){o[n]||(o[n]=[],window.addEventListener(n,e.bind(null,t,n,o[n]),!1)),o[n].push(r)}function t(e,n,t){t=t||window.event;var r=JSON.parse(t.detail);if("object"==typeof r.detail&&r.token!==i){for(var o=r.detail,u=0,f=n.length;f>u;u++)n[u](o);t&&"function"==typeof t.stopPropagation&&t.stopPropagation()}}function r(e,n){var t=document.createEvent("CustomEvent");t.initCustomEvent(e,!0,!0,JSON.stringify({detail:n,token:i})),document.documentElement.dispatchEvent(t)}var i=e.generateToken(),o={};return{addEventListener:n,fireEvent:r}}),define("Message",["utils"],function(e){function n(n,t){i(),f[n]||(f[n]=[]);var r=e.bind(null,t,n);f[n].push(r)}function t(e,n){window.postMessage(JSON.stringify({token:u,event:e,detail:n}),"*")}function r(n){n=n||window.event;var t=JSON.parse(n.data);if("string"==typeof t.event&&"object"==typeof t.detail&&t.token!==u&&e.isArray(f[t.event])){for(var r=f[t.event],i=t.detail,o=0,a=r.length;a>o;o++)r(i);n&&"function"==typeof n.stopPropagation&&n.stopPropagation()}}function i(){o||window.addEventListener("message",r,!1)}var o=!1,u=e.generateToken(),f={};return{addEventListener:n,fireEvent:t}}),define("memFunction",["utils","CustomEvent","Message","support"],function(e,n,t,r){function i(n,t,r){if("object"==typeof n)e.each(n,function(e,u){if("object"==typeof u)n[e]=i(u,t,r);else if("string"==typeof u)n[e]=o(u);else if("function"==typeof u){var f=c.push(u)-1;n[e]="${"+t+"/"+r+"/"+f+"}"}});else if("string"==typeof value)n=o(n);else if("function"==typeof n){var u=c.push(n)-1;n="${"+t+"/"+r+"/"+u+"}"}return n}function o(e){return/^\$[\\]*\{([0-9a-zA-Z\.\-_\/\\]+)\}$/g.test(e)?"$\\"+e.substring(1):e}function u(n,t,r){if(/^\$\{([0-9a-zA-Z\.\-_]+)\/([0-9a-zA-Z\.\-_]+)\/([0-9]+)\}$/g.test(n)){var i=n.substring(2,n.length-1).split("/"),o=parseInt(i[2],10);return i[0]===t&&i[1]===r?c[o]:e.bind(null,a,i[0]+"-"+i[1],o)}return/^\$[\\]+\{([0-9a-zA-Z\.\-_\/\\]+)\}$/g.test(n)?"$"+n.substring(2):n}function f(n,t,r){if("object"==typeof n)e.each(n,function(e,i){if("object"==typeof i)n[e]=f(i,t,r);else if("string"==typeof i)n[e]=u(i,t,r);else if("function"==typeof i)throw Error("Function was found!")});else{if("string"==typeof value)return u(value,t,r);if("function"==typeof value)throw Error("Function was found!")}return n}function a(e,i){var o=Array.prototype.slice.call(arguments,2);return r.CustomEvent?n.fireEvent(e,{callbackId:i,args:o,mem:!0}):t.fireEvent(e,{callbackId:i,args:o,mem:!0})}function s(e){return c[e]}var c=[];return{parseObject:i,restoreObject:f,getCacheFunction:s}}),define("Connection",["CustomEvent","Message","utils","support","memFunction"],function(e,n,t,r,i){function o(i,o){r.CustomEvent?e.addEventListener(i+"-content",t.bind(null,u,o,i,"content")):n.addEventListener(i+"-content",t.bind(null,u,o,i,"content"))}function u(e,n,r,i){setTimeout(t.bind(null,f,e,n,r,i),4)}function f(o,u,f,a){var s=t.getKeys(o),c=t.indexOfArray(a.method,s);if(!(c>-1))throw"Method "+a.method+" has not been set!";var l=o[s[c]].apply(null,i.restoreObject(a.args,u,f));if("number"==typeof a.id){var p=i.parseObject(l,u,f),a={callbackId:a.id,args:[p]};r.CustomEvent?e.fireEvent(u+"-page",a):n.addEventListener(u+"-page",a)}}function a(e){this.token=t.generateToken(),this.functions={},this.namespace="UserProxy",this.pageProxy=e}return a.prototype.setFunctions=function(e){this.functions=e},a.prototype.setNamespace=function(e){this.namespace=e},a.prototype.inject=function(e){var n=document.body||document.head||document.documentElement;if(!n)throw"Parent was not found!";var r=document.createElement("script");r.setAttribute("type","text/javascript");var i=[";(function(unsafeWindow){var "+t.escapeECMAVariable(this.namespace)+" = ("+this.pageProxy+')("'+this.token+'", '+JSON.stringify(t.getKeys(this.functions))+", this);","})(window);"];"string"==typeof e&&(e="function(){"+e+"}"),o(this.token,this.functions),r.appendChild(document.createTextNode(i[0]+"("+e+")();"+i[1])),n.appendChild(r),n.removeChild(r)},a}),define("main",["utils","support","Connection"],function(e,n,t){function r(e){var n=new t(a);n.setFunctions(u),n.setNamespace(f),n.inject(e)}function i(e){u=e}function o(e){f=e}var u={},f="UserProxy",a=function(e,n,t){var r,i,o;return!function(e){function n(e,n){return E.call(e,n)}function t(e,n){var t,r,i,o,u,f,a,s,c,l,p,d=n&&n.split("/"),v=h.map,g=v&&v["*"]||{};if(e&&"."===e.charAt(0))if(n){for(d=d.slice(0,d.length-1),e=e.split("/"),u=e.length-1,h.nodeIdCompat&&j.test(e[u])&&(e[u]=e[u].replace(j,"")),e=d.concat(e),c=0;c<e.length;c+=1)if(p=e[c],"."===p)e.splice(c,1),c-=1;else if(".."===p){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||g)&&v){for(t=e.split("/"),c=t.length;c>0;c-=1){if(r=t.slice(0,c).join("/"),d)for(l=d.length;l>0;l-=1)if(i=v[d.slice(0,l).join("/")],i&&(i=i[r])){o=i,f=c;break}if(o)break;!a&&g&&g[r]&&(a=g[r],s=c)}!o&&a&&(o=a,f=s),o&&(t.splice(0,f,o),e=t.join("/"))}return e}function u(n,t){return function(){return d.apply(e,w.call(arguments,0).concat([n,t]))}}function f(e){return function(n){return t(n,e)}}function a(e){return function(n){y[e]=n}}function s(t){if(n(m,t)){var r=m[t];delete m[t],b[t]=!0,p.apply(e,r)}if(!n(y,t)&&!n(b,t))throw new Error("No "+t);return y[t]}function c(e){var n,t=e?e.indexOf("!"):-1;return t>-1&&(n=e.substring(0,t),e=e.substring(t+1,e.length)),[n,e]}function l(e){return function(){return h&&h.config&&h.config[e]||{}}}var p,d,v,g,y={},m={},h={},b={},E=Object.prototype.hasOwnProperty,w=[].slice,j=/\.js$/;v=function(e,n){var r,i=c(e),o=i[0];return e=i[1],o&&(o=t(o,n),r=s(o)),o?e=r&&r.normalize?r.normalize(e,f(n)):t(e,n):(e=t(e,n),i=c(e),o=i[0],e=i[1],o&&(r=s(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},g={require:function(e){return u(e)},exports:function(e){var n=y[e];return"undefined"!=typeof n?n:y[e]={}},module:function(e){return{id:e,uri:"",exports:y[e],config:l(e)}}},p=function(t,r,i,o){var f,c,l,p,d,h,E=[],w=typeof i;if(o=o||t,"undefined"===w||"function"===w){for(r=!r.length&&i.length?["require","exports","module"]:r,d=0;d<r.length;d+=1)if(p=v(r[d],o),c=p.f,"require"===c)E[d]=g.require(t);else if("exports"===c)E[d]=g.exports(t),h=!0;else if("module"===c)f=E[d]=g.module(t);else if(n(y,c)||n(m,c)||n(b,c))E[d]=s(c);else{if(!p.p)throw new Error(t+" missing "+c);p.p.load(p.n,u(o,!0),a(c),{}),E[d]=y[c]}l=i?i.apply(y[t],E):void 0,t&&(f&&f.exports!==e&&f.exports!==y[t]?y[t]=f.exports:l===e&&h||(y[t]=l))}else t&&(y[t]=i)},r=i=d=function(n,t,r,i,o){if("string"==typeof n)return g[n]?g[n](t):s(v(n,t).f);if(!n.splice){if(h=n,h.deps&&d(h.deps,h.callback),!t)return;t.splice?(n=t,t=r,r=null):n=e}return t=t||function(){},"function"==typeof r&&(r=i,i=o),i?p(e,n,t,r):setTimeout(function(){p(e,n,t,r)},4),d},d.config=function(e){return d(e)},r._defined=y,o=function(e,t,r){t.splice||(r=t,t=[]),n(y,e)||n(m,e)||(m[e]=[e,t,r])},o.amd={jQuery:!0}}(),o("../vendor/almond",function(){}),o("support",[],function(){function e(){try{var e=document.createEvent("CustomEvent");return e&&"function"==typeof e.initCustomEvent?(e.initCustomEvent(n,!0,!0,{mod:n}),!0):!1}catch(e){return!1}}var n="support.test";return{CustomEvent:e}}),o("utils",[],function(){function e(e,n){var t=Array.prototype.slice.call(arguments,2);return function(){return n.apply(e,t.concat(Array.prototype.slice.call(arguments)))}}function n(e,n){if(r(e))for(var t=0;t<e.length&&n(t,e[t])!==!0;t++);else for(var i in e)if(e.hasOwnProperty(i)&&n(i,e[i])===!0)break}function t(e){var t=[];return n(e,function(e){t.push(e)}),t}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e,n){for(var t=0,r=n.length;r>t;t++)if(n[t]===e)return!0;return!1}function o(e,n){for(var t=0,r=n.length;r>t;t++)if(n[t]===e)return t;return-1}function u(e,n){return r(e,n)?o(e,n):void 0}function f(e,n){return Math.random()*(n-e)+e}function a(e,n){return Math.floor(Math.random()*(n-e))+e}function s(e,n){"string"!=typeof e&&(e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_"),"number"!=typeof n&&(n=64);for(var t=e.length,r="",i=0;n>i;i++)r+=e[a(0,t)];return r}function c(e,n){for(e=e.replace(/[^0-9a-zA-Z_\$]/g,"");/$[0-9]/g.test(e);){if(""===e)return n;e=e.substring(1)}return e}return{bind:e,each:n,getKeys:t,isArray:r,inArray:i,indexOf:u,indexOfArray:o,getRandomArbitrary:f,getRandomInt:a,generateToken:s,escapeECMAVariable:c}}),o("CustomEvent",["utils"],function(e){function n(n,r){o[n]||(o[n]=[],window.addEventListener(n,e.bind(null,t,n,o[n]),!1)),o[n].push(r)}function t(e,n,t){t=t||window.event;var r=JSON.parse(t.detail);if("object"==typeof r.detail&&r.token!==i){for(var o=r.detail,u=0,f=n.length;f>u;u++)n[u](o);t&&"function"==typeof t.stopPropagation&&t.stopPropagation()}}function r(e,n){var t=document.createEvent("CustomEvent");t.initCustomEvent(e,!0,!0,JSON.stringify({detail:n,token:i})),document.documentElement.dispatchEvent(t)}var i=e.generateToken(),o={};return{addEventListener:n,fireEvent:r}}),o("Message",["utils"],function(e){function n(n,t){i(),f[n]||(f[n]=[]);var r=e.bind(null,t,n);f[n].push(r)}function t(e,n){window.postMessage(JSON.stringify({token:u,event:e,detail:n}),"*")}function r(n){n=n||window.event;var t=JSON.parse(n.data);if("string"==typeof t.event&&"object"==typeof t.detail&&t.token!==u&&e.isArray(f[t.event])){for(var r=f[t.event],i=t.detail,o=0,a=r.length;a>o;o++)r(i);n&&"function"==typeof n.stopPropagation&&n.stopPropagation()}}function i(){o||window.addEventListener("message",r,!1)}var o=!1,u=e.generateToken(),f={};return{addEventListener:n,fireEvent:t}}),o("memFunction",["utils","CustomEvent","Message","support"],function(e,n,t,r){function i(n,t,r){if("object"==typeof n)e.each(n,function(e,u){if("object"==typeof u)n[e]=i(u,t,r);else if("string"==typeof u)n[e]=o(u);else if("function"==typeof u){var f=c.push(u)-1;n[e]="${"+t+"/"+r+"/"+f+"}"}});else if("string"==typeof value)n=o(n);else if("function"==typeof n){var u=c.push(n)-1;n="${"+t+"/"+r+"/"+u+"}"}return n}function o(e){return/^\$[\\]*\{([0-9a-zA-Z\.\-_\/\\]+)\}$/g.test(e)?"$\\"+e.substring(1):e}function u(n,t,r){if(/^\$\{([0-9a-zA-Z\.\-_]+)\/([0-9a-zA-Z\.\-_]+)\/([0-9]+)\}$/g.test(n)){var i=n.substring(2,n.length-1).split("/"),o=parseInt(i[2],10);return i[0]===t&&i[1]===r?c[o]:e.bind(null,a,i[0]+"-"+i[1],o)}return/^\$[\\]+\{([0-9a-zA-Z\.\-_\/\\]+)\}$/g.test(n)?"$"+n.substring(2):n}function f(n,t,r){if("object"==typeof n)e.each(n,function(e,i){if("object"==typeof i)n[e]=f(i,t,r);else if("string"==typeof i)n[e]=u(i,t,r);else if("function"==typeof i)throw Error("Function was found!")});else{if("string"==typeof value)return u(value,t,r);if("function"==typeof value)throw Error("Function was found!")}return n}function a(e,i){var o=Array.prototype.slice.call(arguments,2);return r.CustomEvent?n.fireEvent(e,{callbackId:i,args:o,mem:!0}):t.fireEvent(e,{callbackId:i,args:o,mem:!0})}function s(e){return c[e]}var c=[];return{parseObject:i,restoreObject:f,getCacheFunction:s}}),o("proxy",["support","CustomEvent","Message","utils","memFunction"],function(r,i,o,u,f){function a(n){if("number"==typeof n.callbackId&&u.isArray(n.args)&&n.mem){var t=f.restoreObject(n.args,e,"page"),r=f.getCacheFunction(n.callbackId);"function"==typeof r&&r.apply(null,t)}else{if("number"!=typeof n.callbackId||!u.isArray(n.args))throw Error("Malformed detail!",n);var t=f.restoreObject(n.args,e,"page");"function"==typeof l[n.callbackId]&&l[n.callbackId].apply(null,t),l[n.callbackId]=null}}function s(n,t){function u(e){clearTimeout(p),"function"==typeof e&&(s.id=l.push(e)-1),a()}function a(){r.CustomEvent?i.fireEvent(e+"-content",s):o.fireEvent(e+"-content",s)}if(t=Array.prototype.slice.call(arguments,1),!c(n))throw Error(n+" is not a defined function!");t=f.parseObject(t,e,"page");var s={method:n,args:t},p=setTimeout(a,4);return{then:u}}function c(e){return u.indexOfArray(e,n)>-1}var l=[];r.CustomEvent?i.addEventListener(e+"-page",a):o.addEventListener(e+"-page",a);for(var p=0,d=n.length;d>p;p++)t[n[p]]=u.bind(null,s,n[p]);return{call:s,has:c}}),i("proxy")};return{connect:r,setFunctions:i,setNamespace:o}});;return require("main");})();